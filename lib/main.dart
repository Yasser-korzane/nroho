import 'package:appcouvoiturage/Models/Users.dart';
import 'package:appcouvoiturage/Services/auth.dart';
import 'package:appcouvoiturage/Services/localNotification.dart';
import 'package:appcouvoiturage/pages/begin.dart';
import 'package:appcouvoiturage/pages/home.dart';
import 'package:flutter/material.dart';
import 'package:appcouvoiturage/Services/wrapper.dart';
import 'package:provider/provider.dart';
import 'package:firebase_core/firebase_core.dart';
import 'package:flutter/services.dart';
import 'package:appcouvoiturage/pages/welcomepage.dart';
import 'package:appcouvoiturage/pages/trajetdetailsconducteurs.dart';
import 'package:firebase_messaging/firebase_messaging.dart';
import 'package:appcouvoiturage/pages/page_recherche.dart';

Future<void> main() async {
  WidgetsFlutterBinding.ensureInitialized();
  await Firebase.initializeApp();
  NotificationSettings settings = await FirebaseMessaging.instance.requestPermission();
  print(settings.authorizationStatus);
  final fcm =await FirebaseMessaging.instance.getToken();
  print(fcm);
  /*LocalNotification.initialize();
  FirebaseMessaging.onMessage.listen((RemoteMessage message) {
    LocalNotification.showNotification(message);
  });*/
  SystemChrome.setPreferredOrientations([
    DeviceOrientation.portraitUp,
  ]).then((_) {
    runApp(
      MaterialApp(
        debugShowCheckedModeBanner: false,
        theme: ThemeData(fontFamily: 'Poppins'),
        home: MyApp(),//Details(photoUrl: "data:image/jpeg;base64,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", fullName: "Boulacheb Hichem", rating: 5, phoneNumber: "055935791", email: "lh_boulacheb@esi.dz", carName: "Toyota"),
        routes: {
          "trajet": (context) {
            return const WelcomePage();
          },
          "home": (context) {
            return const home();
          }
        },
      ),
    );
  });
}

class MyApp extends StatelessWidget {
  const MyApp({super.key});

  @override
  Widget build(BuildContext context) {
    return StreamProvider<Users?>.value(
      catchError: (User, Users) => null,
      initialData: null,
      value: AuthService().user,
      child: MaterialApp(
        debugShowCheckedModeBanner: false,
        title: 'Flutter Demo',
        /*initialRoute: '/commencer',
        routes: {
          '/signin':(context) => const Connexin(title: 'connextion '),
          '/signup':(context) => const MyHomePage(title: 'SingnUp'),
          '/commencer':(context) => const MyBeginPage(title: 'begin') ,
        },*/
        theme: ThemeData(
          colorScheme: ColorScheme.fromSeed(seedColor: Colors.blue),
          useMaterial3: true,
        ),
        home: const Wrapper(),
      ),
    );
  }
}
